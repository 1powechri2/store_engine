<h1>Order</h1>

<p>
  <b>Name</b><br>
  <%= @order.name %>
</p>

<p>
  <b>Address</b><br>
  <%= @order.address %>
</p>

<p>
  <b>Email</b><br>
  <%= @order.email %>
</p>

<p>
  <b>Status</b><br>
  <%= @order.status %>
    <% if can? :update, @order %> 
      <% if @order.next_status %>
        <%= form_for @order do |f| %>
          <%= f.hidden_field :status, :value => @order.next_status, :class => 'btn' %>
          <%= f.submit "mark as #{@order.next_status}", :class => 'btn' %>
        <% end %>
      <% end %>
    <% end %> 
</p>

<p>
  <b>Pay type</b><br>
  <%= @order.pay_type %>
</p>

<h3>Products Ordered:</h3>
<p> 
  <% @order.order_items.each do |order_item| %>
    <%= link_to order_item.product.title, product_path %> <br />
    Quantity: <%= order_item.quantity%> <br />
    Price: <%= order_item.price %><br />
    Subtotal: <%= order_item.subtotal %><br />
  <% end %>
</p>  

<p>
  Total: <%= @order.total %>
</p> 

<div class="form-actions">
  <% if can? :update, @order %> 
    <%= link_to 'View All Orders', orders_path, :class => 'btn'  %>
    <%= link_to 'Edit', edit_order_path(@order), :class => 'btn' %>
    <%=link_to "Update Status", edit_order_path, :class => 'btn' %>
  <% end %>
</div>
